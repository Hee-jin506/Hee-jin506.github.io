---
layout: post
title: "[스프링 핵심 원리 - 기본편] 1. 객체지향 설계와 스프링"
categories:
  - Spring
tags:
  - 스프링 핵심 원리 - 기본편

---

## 자바 진영의 추운 겨울과 스프링의 탄생

### EJB 시대

2000년대 초반에 스프링 기술 중에서 최고봉인  EJB(Enterprise Java Beans) 기술이 있었다. 지금으로 따지면 스프링이랑 JPA를 모두 합쳐놓은 자바 종합 세트였으므로, 금융권이나 아키텍트 같은 분들이 많이 사용헀다. 그래서 기술 영업을 할때 EJB를 갖고 영업을 많이 했다. 자바 진영에서 표준적으로 정한 기술이라고 홍보하며 다양한 회사들이 EJB로 구현한 서버를 판매했다. 금융권에서도 표준 기술을 사용하는 것이 신뢰가 간다고 여겨져 자주 사용되곤 했다. 당시에는 컨테이너 기술이라든가, 설정에 의한 트랜잭션 관리, 트랜잭션을 설정해놓으면 간단하게 걸리기도 했고, 분산에 대한 지원 등 고급 기술이 잘 지원됐고, 이론적인 부분이 좋았다. 또한 당시에 소위말하는 ORM 기술(자바 객체를 DB에 편하게 저장하고 꺼내는 기술)도 갖고 있었다. 그런데 이것이 수천만원짜리 서버가 필요할 정도로 비용이 굉장히 비쌌다. EJB는 또한 이론은 좋은 데에 비해 어렵고 복잡하고 느렸다. EJB가 제공하는 인터페이스를 모두 구현하고,  EJB에 의존적으로 개발해야했다. 그야말로 EJB는 개발자들의 지옥과 같았다. EJB 인터페이스를 의존적으로 설계하는 점이 특히 치명적이었는데, 코드가 너무 지저분해서 차라리 POJO로 돌아가자는 말이 나올 정도였다. 당시에 ORM 표준이라고 할 수 있는 EJB에서 제공되는 엔티티빈 기술은 기술 수준 자체가 낮았다. 

이때 개빈 킹이라는 개발자가 있는 Hibernate를 만들고, 로드 존슨이라는 개발자가 스프링 프레임워크를 만들었다. 두 기술 모두 오픈소스였다. 

로드 존슨은 EJB를 사용하여 개발을 했던 SI 개발자였다. EJB를 비판하면서 책을 썼고, EJB보다 훨씬 단순하면서 좋은 방법으로 개발할 수 있는 방법을 제안했고, 이것이  미래에 스프링이 되었다.

또한 개빈 킹은 EJB의 엔티티빈 기술을 대체할 Hibernate라는 오픈소스 기술을 만들었다. 그리고 그 이후로 사람들이 점점 엔티티빈 대신 Hibernate를 사용하기 시작하면서, 자바의 표준을 논의하는 곳에서 EJB의 엔티티빈 대신 개빈 킹을 섭외하여 Hibernate를 거의 모두 사용하여 만든 자바 표준인 JPA를 만든다. 표준 기술인 JPA는 인터페이스고 구현체를 하이버네이트나 EclipseLink 등이 있지만, 대부분 하이버네이트를 사용한다. JPA는 자바 표준 기술이긴 하지만 잘 안착을 하여 자바 진영의 ORM 시장은 대부분 JPA가 장악하고 있다. 그리고 구현체는 80퍼센트 이상 하이버네이트가 사용되고 있다. 하이버네이트는 실무 개발자들이 답답해서 만든 것이므로, 필드에 있는 개발자들이 좋다고 생각한 것을 갖고 만든 것이지만 그때그때 실무 개발자들의 결정이 반영되므로 용어나 개념에 반영되므로, 정제가 덜 된 감이 있다. 실제 개발자들이 사용하던 기술에다가 표준이 들어오게 되면 용어나, API에 대해서 필요없는 것들을 덜어내야하는데, 그래서 깔끔하게 정제될 수 밖에 없다. 실무에서 오는 실용성과 표준에서의 오는 안정성이 합쳐져서 JPA가 나오게 되어 성공적인 기술이 되었다.

### 스프링의 역사

로드 존슨이라는 개발자가 J2EE Design and Development라는 책을 출간하면서 스프링의 역사가 시작된다. 이 책을 통해 로드 존슨은 EJB의 문제점을 모두 지적하면서 EJB가 없어도 충분히 고품질의 확장 가능한 애플리케이션 개발 방법을 보여준다. 3만 라인 정도의 기반 기술을 예제 코드로 푼다. 이 코드 안의 스프링의 핵심 개념이 모두 들어가 있다. 이 책이 나오자마자 히트를 치고, 많은 개발자들이 이 예제 코드를 자신의 실제 프로젝트에 사용했다.

이때 책이 출간되고 나서 유겐 휠러와 얀 카로프 개발자가 로드 존슨에게 오픈소스 프로젝트를 하자고 제안했다. 지금까지도 유겐 휠러는 스프링의 핵심 코드에 상당수 기여를 하고 있다. 스프링이라는 이름은 얀 카로프가 지었으며, EJB라는 겨울을 넘어 새로운 시작이라는 뜻으로 스프링이라고 지었다. 참고로, 우리 강의 시작은 바로 저 처음으로 갈 것이다. 그 3만 라인의 예제 코드가 대체 얼마나 매력적이었길래 그렇게 열광했고, 지금까지도 사용되고 있는 지에 대해서부터 알아볼 것이다. 

> **릴리즈**
>
> - 2003년 스프링 프레임워크 1.0 - XML
> - 2006년 스프링 프레임워크 2.0 - XML 편의 기능 지원
> - 2009년 스프링 프레임워크 3.0 - 자바 코드로 설정
> - 2013년 스프링 프레임워크 4.0 - 자바 8
> - 2014년 스프링 부트 1.0 출시
> - 2017년 스프링 프레임워크 5.0 / 스프링 부트 2.0 - 리엑티브 프로그래밍 지원
> - 2020년 9월 현재 스프링 프레임워크 5.2.x, 스프링 부트 2.3.x 

___

## 스프링이란?

### 스프링 생태계

스프링은 특정한 기술 하나가 아니라 여러가지 기술들의 모음이라고 볼 수 있다. 

필수 기술

- 스프링 프레임워크 : 스프링의 핵심 기술
- 스프링 부트 : 다양한 스프링 기술을 편리하게 사용할 수 있도록 돕는 기술

선택 기술

- 스프링 데이터 : 데이터베이스와 상관없이 기본적인 CRUD 기능을 편리하게 사용할 수 있도록 도와주는 기술로 대표적인 것은 스프링 데이터 JPA가 있다.
- 스프링 세션 : 세션 기능을 편리하게 사용할 수 있도록 도와주는 기술
- 스프링 시큐리티 : 보안과 관련된 기능을 편리하게 사용할 수 있도록 도와주는 기술
- 스프링 Rest Docs : API 문서화를 편리하게 해주는 기술
- 스프링 배치 : 배치 처리에 특화된 기술
- 스프링 클라우드 : 클라우드에 특화된 기술

이외에도 굉장히 많은 기술들이 있다. 다른 기술을 확인하고 싶다면 다음 페이지를 참고하면 된다. https://spring.io/projects 

### 스프링 프레임워크

- 핵심 기술: 스프링 DI 컨테이너, AOP, 이벤트, 기타

- 웹 기술: 스프링 MVC, 스프링 WebFlux
- 데이터 접근 기술: 트랜잭션, JDBC, ORM 지원, XML 지원
- 기술 통합: 캐시, 이메일, 원격접근, 스케줄링
- 테스트: 스프링 기반 테스트
- 언어: 코틀린, 그루비
- 최근에는 스프링 부트를 통해서 스프링 프레임워크의 기술들을 편리하게 사용할 수가 있다.

### 스프링 부트

- 스프링을 편리하게 사용할 수 있도록 지원, 최근에는 기본으로 사용
- 단독으로 실행할 수 있는 스프링 애플리케이션을 쉽게 생성 :
  Tomcat 같은 웹 서버를 내장해서 별도의 웹 서버를 설치하지 않아도 됨
- 손쉬운 빌드 구성을 위한 starter 종속성 제공 :
  starter가 하나의 라이브러리를 가져오면, 그 라이브러리가 종속된 또 다른 라이브러리들을 모두 가져온다.
- 스프링과 3rd parth(외부) 라이브러리 자동 구성 :
  스프링 버전에 맞게 외부 라이브러리들의 버전을 최적화하므로 외부 라이브러리의 버전 호환성을 확인할 필요 X
- 메트릭, 상태 확인, 외부 구성 같은 프로덕션 준비 기능 제공 :
  운영 환경에서의 기본적인 모니터링 기능 제공
- 관례에 의한 간결한 설정

스프링 부트에 대한 오해가 있는데, 스프링 부트는 스프링 프레임워크와 별도로 사용할 수 있는 것이 아니다. 스프링 부트는 스프링 프레임워크를 비롯하여 다양한 기술들을 편리하게 사용할 수 있는 기능을 제공하는 껍데기인 셈이다. 따라서 스프링 부트만으로는 동작이 절대 되지 않는다.

### 스프링 단어?

스프링이라는 단어는 문맥에 따라 다르게 사용된다.

- 스프링 DI 컨테이너 기술 
- 스프링 프레임워크
- 스프링 부트, 스프링 프레임워크 등을 모두 포함한 스프링 생태계

### 스프링의 핵심 개념

> 이 기술을 왜 만들었는가? 이 기술의 핵심 컨셉은?
>
> - 웹 어플리케이션 만들고,  DB 접근 편리하게 해주는 기술?
> - 전자정부 프레임워크?
> - 웹 서버도 자동으로 띄워주고?
> - 클라우드, 마이크로서비스? 
>
> 위의 것들은 핵심이 아니라, 결과물일 뿐이다.

**스프링은 자바 언어 기반의 프레임워크** 

-> **자바 언어의 가장 큰 특징 - 객체 지향 언어**

-> **스프링은 객체 지향 언어가 가진 강력한 특징을 살려내는 프레임워크**

-> **스프링은 <u>좋은 객체 지향 애플리케이션</u>을 개발할 수 있게 도와주는 프레임워크**

로드 존슨이 EJB를 의존하여 개발을 하면 객체 지향이 가진 장점들이 손실되는 것을 깨달았고, 이 장점들을 스프링이 가진 DI 컨테이너에서 효과적으로 활용이 가능하게 만들었다. 

___

## 좋은 객체 지향 프로그래밍?

### 객체 지향 특징

- 추상화
- 캡슐화
- 상속
- 다형성

### 객체 지향 프로그램밍

- 객체 지향 프로그래밍은 컴퓨터 프로그램을 명령어의 목록으로 보는 시각에서 벗어나 여러 개의 독립된 단위, 즉 **"객체"**들의 **모임**으로 파악하고자 하는 것이다. 각각의 **객체**는 **메시지**를 주고 받고, 데이터를 처리할 수 있다.**(협력)**
- 객체 지향 프로그래밍은 프로그램을 **유연**하고 **변경**이 용이하게 만들기 떄문에 대규모 소프트웨어 개발에 많이 사용된다.

### 유연하고, 변경이 용이?

- 레고 블럭 조립하듯이
- 키보드, 마우스 갈아 끼우듯이
- 컴퓨터 부품 갈아 끼우듯이
- 컴포넌트를 쉽고 유연하게 변경하면서 개발할 수 있는 방법

이러한 것들을 **<u>다형성</u>**이라는 특징으로 대표할 수가 있다.

### 다형성(Polymorphism)의 실세계 비유

이 세상을 역할과 구현으로 구분한다고 가정해보자.

#### 운전자와 자동차

운전자와 자동차의 역할이 있다고 해보자. 이 자동차의 역할을 K3, 아반떼, 테슬라 모델3 이렇게 세 개의 서로 다른 자동차가 구현한다. 그럼 운전자는 K3를 타다가 아반떼로 자동차를 바꾼다고 해도 충분히 운전이 가능하고, 운전자에게 영향을 주지 않는다. 운전자는 아반떼에 맞추어 새로운 운전 방법을 배울 필요가 없다.

유연하고 변경이 용이하다는 것은 K3 -> 아반떼로 자동차를 바꿔도 운전이 가능한 현상으로 비유될 수 있다. 이것이 가능한 이유는 자동차의 역할의 interface를 모든 자동차가 구현했으며, 운전자는 자동차의 인터페이스에 대해서만 알고, 의존하고 있기 때문이다. 핵심은, 자동차 역할을 만들고 이를 구현과 분리한 것이 운전자를 위한 방법론이라는 점이다. 또한, 자동차의 역할 인터페이스만 따라준다면, 얼마든지 새로운 자동차가 구현될 수 있으며, 이러한 방식으로 무한히 확장이 가능하다. 기름 자동차에서 전기 자동차가 나왔다하더라도, 인터페이스만 따라준다면 얼마든지 구현이 가능하다. 프로그래밍 관점에서 이를 바꿔 말하면 클라이언트에 영향을 주지 않고, 새로운 기능을 제공할 수 있다. 이 모든 것이 역할과 구현을 분리했기 때문에 가능하다. 클라이언트는 새로운 것을 알거나 무언가를 바꿀 필요가 없다.

#### 로미오와 줄리엣 공연

공연을 기획하는 입장이 되었다고 상상해보자. 로미오 역할과 줄리엣 역할이 있다. 장동건과 원빈이 로미오 역할을 할 수도 있고, 줄리엣 역할은 김태희나 송혜교, 또는 무명 배우가 수행할 수 있다. 중요한 점은 배우는 대체가 가능해야 된다는 점이다. 이 공연에서 역할과 구현을 분리했기 때문에 대체 가능성이 생긴다. 또한 로미오 배우의 입장에서 줄리엣 배우가 누가 됐든지 간에, 본인 대본만 잘 익힌다면, 아무런 문제 없이 자신의 역할을 수행할 수 있다. 따라서 얼마든지 배우를 변경할 수 있으므로, 변경 용이성이 발생한다.

### 또 다른 예시

- 키보드, 마우스, 세상의 표준 인터페이스
- 정렬 알고리즘
- 할인 정책 로직

### 역할과 구현을 분리

역할과 구현으로 구분하면 세상이 

- **단순**해지고 
- **유연**해지며 
- **변경도 편리**해진다.

따라서 다음과 같은 장점이 따라온다.

- **클라이언트**는 **대상의 역할(인터페이스)만 알면** 된다.
- **클라이언트**는 구현 대상의 **내부 구조를 몰라도** 된다.
- **클라이언트**는 구현 대상의 **내부 구조가 변경**되어도 영향을 받지 않는다.
- **클라이언트**는 **구현 대상 자체를 변경**해도 영향을 받지 않는다.

### 자바의 다형성

- 역할 = 인터페이스
- 구현 = 인터페이스를 구현한 클래스, 구현 객체

객체를 설계할 때 역할과 구현을 명확히 분리한다. 객체를 설계할 때, 일단 인터페이스를 먼저 설계한 후, 그 다음에 이를 구현할 객체를 만드는 것이다. 핵심은 구현보다 인터페이스가 먼저이다.   